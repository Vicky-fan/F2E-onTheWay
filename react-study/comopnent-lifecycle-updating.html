<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>组件生命周期</title>
	<h2>组件生命周期</h2>
	<div id="app"></div>
	
	<script src="build/react.js"></script>
	<script src="build/JSXTransformer.js"></script>
	<script type="text/jsx">
	var LifeApp = React.createClass({
		getInitialState: function () {
			return {
				count: 0
			}
		},
		getDefaultProps: function () {
			return {}
		},

		killMe: function () {
			alert('you are tring to kill me !! ');
			React.unmountComponentAtNode(document.getElementById('app'));
		},
		doUpdate: function () {
			this.setState({
				count: this.state.count + 1
			});
		},
		shouldComponentUpdate: function (nextProps, nextState) {
			console.log('shouldComponentUpdate');
			if (nextState.count > 10 ) {
				return false;
			}
			return true;
		},
		componentWillUpdate: function (nextProps, nextState) {
			console.log('componentWillUpdate');
		},
		componentDidUpdate: function (prevProps, prevState) {
			console.log('componentDidUpdate');
		},
		render: function () {
			console.log('渲染');
			return (
				<div>
					<p>当前技数是{this.state.count}</p>
					<button onClick={this.killMe}>卸载组件</button>
					<button onClick={this.doUpdate}>手动更新一下组件（包括子组件）</button>
					<SubApp count={this.state.count} />
				</div>
			)
		}
	});

	var SubApp = React.createClass({
		componentWillReceiveProps: function (nextProps) {
			console.log('子组件将要获得prop');
		},
		shouldComponentUpdate: function (nextProp,nextState) {
			console.log('子组件shouldComponentUpdate')
			if (nextProp.count>5) {
				return false;
			}
			return true;
		},
		render: function () {
			return (
				<p>子组件当前的计数是： {this.props.count}</p>
			)
		}
	});
	var lifeApp = React.render(
		<LifeApp />,
		document.getElementById('app'),
		function () {
			console.log('渲染完毕！');
		}
	);
	
	</script>
</head>
<body>
	